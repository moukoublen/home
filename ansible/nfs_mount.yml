---
- hosts: all
  become: true
  become_user: root
  tasks:
    - name: Create the directory to mount nfs
      ansible.builtin.file:
        path: /pupa
        state: directory
        mode: '0777'

    - name: Install nfs-common
      ansible.builtin.apt:
        pkg:
          - nfs-common
        state: present

    - name: Mount the NFS volume
      ansible.posix.mount:
        src: 192.168.1.240:/pupa
        path: /pupa
        opts: nfsvers=3,rw,nosuid,nodev,async,hard,intr,_netdev,nofail,x-systemd.automount,x-systemd.device-timeout=10s
        dump: "0"
        passno: "0"
        state: mounted
        fstype: nfs
